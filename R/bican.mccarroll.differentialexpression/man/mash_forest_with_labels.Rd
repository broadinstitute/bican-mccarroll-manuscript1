% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mashR.R
\name{mash_forest_with_labels}
\alias{mash_forest_with_labels}
\title{Forest plot of mash posteriors (optional raw overlay) with per-condition calls}
\usage{
mash_forest_with_labels(
  m,
  gene,
  level = 0.95,
  metric = c("lfsr", "custom"),
  metric_matrix = NULL,
  thresh = 0.05,
  call_rule = c("metric", "ci", "both", "either"),
  col_sig = "firebrick",
  col_ns = "black",
  ci_sig = "firebrick",
  ci_ns = "grey60",
  lwd_sig = 2,
  lwd_ns = 1,
  pch_pts = 15,
  cex_names = 0.9,
  order_by = c("effect", "abs_effect", "none"),
  top_largest = TRUE,
  colors = NULL,
  zero_col = "grey70",
  plot_raw = FALSE,
  col_raw = "steelblue4",
  ci_raw = "steelblue3",
  lwd_raw = 1,
  pch_raw = 16,
  raw_y_offset = 0.18,
  raw_side = c("below", "above")
)
}
\arguments{
\item{m}{A fitted `mash` object.}

\item{gene}{Character gene ID (matching rownames of `ashr::get_pm(m)`) or
1-based integer row index.}

\item{level}{Two-sided posterior CI level (default `0.95`).}

\item{metric}{One of `c("lfsr","custom")`. If `"lfsr"`, uses
`ashr::get_lfsr(m)`; if `"custom"`, supply `metric_matrix` with same
dimensions as `ashr::get_pm(m)`.}

\item{metric_matrix}{Numeric matrix used when `metric="custom"`.}

\item{thresh}{Threshold for `metric` (e.g., `0.05` for lfsr).}

\item{call_rule}{One of `c("metric","ci","both","either")` determining how
per-condition “significant” is defined.}

\item{col_sig, col_ns}{Colors for significant / not significant **points**.}

\item{ci_sig, ci_ns}{Colors for significant / not significant **CIs**.}

\item{lwd_sig, lwd_ns}{Line widths for significant / not significant CIs.}

\item{pch_pts}{Point shape for posterior means.}

\item{cex_names}{Size of condition labels on the y-axis.}

\item{order_by}{One of `c("effect","abs_effect","none")` for row order.}

\item{top_largest}{Logical. If `TRUE` (default), largest effects appear at top.}

\item{colors}{Optional list like `meta.colors()` to control bg/axes/text.}

\item{zero_col}{Color of the vertical zero line.}

\item{plot_raw}{Logical. If `TRUE`, overlay raw (input) mean ± CI using
`m$data$Bhat` and `m$data$Shat`. Requires that those matrices are present
in `m$data`. Default `FALSE`.}

\item{col_raw}{Color for raw points (default `"steelblue4"`).}

\item{ci_raw}{Color for raw CIs (default `"steelblue3"`).}

\item{lwd_raw}{Line width for raw CIs (default `1`).}

\item{pch_raw}{Point shape for raw means (default `16`).}
}
\value{
(Invisibly) a list with the vectors used for plotting:
  `sig`, `order`, `lo`, `hi`, `pm`, and if `plot_raw=TRUE`,
  `raw_lo`, `raw_hi`, `raw_pm`.
}
\description{
For a single gene, plot posterior means and CIs from a fitted `mash` object
across conditions (cell types). Conditions can be colored by a significance
rule based on a metric (default **lfsr**), CI exclusion of 0, or both.
Optionally overlay the **raw** (pre-mash) estimates and CIs taken from the
mash input (`m$data$Bhat`, `m$data$Shat`) to visualize shrinkage.
}
