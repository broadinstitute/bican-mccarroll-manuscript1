% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction.R
\name{predict_age_by_celltype}
\alias{predict_age_by_celltype}
\title{Train donor age prediction models across all cell types and write results}
\usage{
predict_age_by_celltype(
  data_dir,
  data_name,
  result_dir,
  age_de_results_dir,
  outPDFFile = NULL,
  contig_yaml_file,
  reduced_gtf_file,
  donor_col = "donor",
  age_col = "age",
  seed = 42,
  fdr_threshold = 0.05,
  optimize_alpha = FALSE,
  alpha_fixed = 0.5,
  mc_repeats = 200,
  min_donors = 50
)
}
\arguments{
\item{data_dir}{Directory containing the serialized input object used by
\code{bican.mccarroll.differentialexpression::prepare_data_for_differential_expression()}.}

\item{data_name}{Name of the dataset object to load (passed through to
\code{prepare_data_for_differential_expression()}).}

\item{result_dir}{Output directory for covariates, metrics, and predictions/residuals}

\item{age_de_results_dir}{Directory containing per-cell-type age differential expression
results used by \code{\link{get_age_de_results}} and \code{\link{predict_age_celltype}}.}

\item{outPDFFile}{Optional path to a PDF file. If provided, QC plots generated during
processing are printed to this PDF; otherwise plots are printed to the active device.}

\item{contig_yaml_file}{Path to the contig-groups YAML file used by
\code{\link{filter_dge_to_autosomes}}.}

\item{reduced_gtf_file}{Path to the reduced GTF used by \code{\link{filter_dge_to_autosomes}}.}

\item{donor_col}{Column name in \code{dge$samples} identifying the donor. Default \code{"donor"}.}

\item{age_col}{Column name in \code{dge$samples} giving chronological age. Default \code{"age"}.}

\item{seed}{Integer random seed used for splitting/training inside \code{\link{predict_age_celltype}}.}

\item{fdr_threshold}{FDR cutoff used when filtering to age DE genes inside
\code{\link{predict_age_celltype}}. Default \code{0.05}.}

\item{optimize_alpha}{Logical; if \code{TRUE}, select elastic net \code{alpha} by grid search
(via \code{\link{train_enet_cv_optimize_alpha}}). If \code{FALSE}, use \code{alpha_fixed}.}

\item{alpha_fixed}{Numeric elastic net \code{alpha} used when \code{optimize_alpha = FALSE}
(\code{0} ridge, \code{1} lasso). Default \code{0.5}.}

\item{mc_repeats}{Integer; number of repeated stratified 80/20 splits used for the final
Monte Carlo residual summaries inside \code{\link{predict_age_celltype}}.}

\item{min_donors}{Minimum number of donors required to fit a model for a given cell type.}
}
\description{
Loads a donor-level RNA-seq dataset (as a \code{DGEList}), restricts to autosomal genes,
and then fits a donor age prediction model per cell type . For each successfully fit
cell type, this function generates QC plots and writes
concatenated tab-delimited outputs (donor predictions, model coefficients, and metrics)
across all cell types.
}
\details{
Cell types may be skipped due to insufficient genes after filtering.
}
