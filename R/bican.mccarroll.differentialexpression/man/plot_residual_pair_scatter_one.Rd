% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction_residuals.R
\name{plot_residual_pair_scatter_one}
\alias{plot_residual_pair_scatter_one}
\title{Plot residual scatter for a single pair of columns}
\usage{
plot_residual_pair_scatter_one(
  model_predictions,
  mode = c("within_region", "within_cell_type"),
  cell_type = NULL,
  region = NULL,
  x_group,
  y_group,
  value_var = "resid_mean",
  donor_id_col = "donor",
  color_var = "age",
  color_title = "Donor age",
  point_size = 2,
  point_alpha = 0.7,
  lm_linewidth = 0.6,
  annotate_r_size = 5,
  pad_frac = 0.1
)
}
\arguments{
\item{donor_id_col}{Column name in `donor_meta` containing donor IDs.
Matched to `rownames(res_mat)`.}

\item{color_var}{Column name in `donor_meta` used to color points. If no finite
values are present after merging, points are drawn in a single color.}

\item{color_title}{Optional legend title for the color scale. If `NULL`,
defaults to `color_var`.}

\item{point_size}{Point size used for the scatter.}

\item{point_alpha}{Point transparency used for the scatter.}

\item{lm_linewidth}{Line width for the linear regression fit.}

\item{annotate_r_size}{Text size for the correlation annotation.}

\item{pad_frac}{Fraction of the data range used to pad the shared x/y limits.}

\item{res_mat}{A numeric matrix of residuals with donors in rows and variables
(e.g., regions or cell types) in columns. Must have `rownames(res_mat)` as
donor IDs and `colnames(res_mat)` containing `x_name` and `y_name`.}

\item{x_name}{A single string giving the column name in `res_mat` to plot on
the x axis.}

\item{y_name}{A single string giving the column name in `res_mat` to plot on
the y axis.}

\item{donor_meta}{Optional data.frame or data.table containing donor-level
metadata for coloring points. If provided, must include `donor_id_col` and
`color_var`.}
}
\value{
A `ggplot` object, or `NULL` if fewer than two finite (x, y) pairs are
  available after filtering.
}
\description{
Create a single residual-vs-residual scatter plot for two columns of a residual
matrix, optionally coloring points by a donor-level metadata variable. The plot
includes a y=x reference line, a linear regression fit, and an annotation of the
Pearson correlation computed on finite x/y pairs. The x and y limits are shared
and padded to enforce a square comparison scale.
}
\examples{
# res_mat: donors x regions residual matrix
# donor_meta: data.frame with columns donor and age
p <- plot_residual_pair_scatter_one(
    res_mat = res_mat,
    x_name = "CaH",
    y_name = "DFC",
    donor_meta = donor_meta,
    donor_id_col = "donor",
    color_var = "age"
)
if (!is.null(p)) print(p)

}
