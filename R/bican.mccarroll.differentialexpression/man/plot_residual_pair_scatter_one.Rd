% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction_residuals.R
\name{plot_residual_pair_scatter_one}
\alias{plot_residual_pair_scatter_one}
\title{Plot residual scatter for one pair of groups within a slice}
\usage{
plot_residual_pair_scatter_one(
  model_predictions,
  mode = c("within_region", "within_cell_type"),
  cell_type = NULL,
  region = NULL,
  x_group,
  y_group,
  value_var = "resid_mean",
  donor_id_col = "donor",
  color_var = "age",
  color_title = "Donor age",
  point_size = 2,
  point_alpha = 0.7,
  lm_linewidth = 0.6,
  annotate_r_size = 5,
  pad_frac = 0.1
)
}
\arguments{
\item{model_predictions}{A data.frame or data.table of donor-level predictions.
Must contain columns `donor`, `cell_type`, `region`, `age`, and the column
specified by `value_var`.}

\item{mode}{Character scalar. Either `"within_region"` (compare cell types
within a fixed region) or `"within_cell_type"` (compare regions within a
fixed cell type).}

\item{cell_type}{Character scalar giving the cell type slice when
`mode = "within_cell_type"`. Ignored when `mode = "within_region"`.}

\item{region}{Character scalar giving the region slice when
`mode = "within_region"`. Ignored when `mode = "within_cell_type"`.}

\item{x_group}{Character scalar giving the first group to plot on the x axis.
This must be a value of the compared dimension (cell type for
`"within_region"`, region for `"within_cell_type"`).}

\item{y_group}{Character scalar giving the second group to plot on the y axis.}

\item{value_var}{Character scalar giving the residual column to plot
(e.g., `"resid_mean"` or `"resid_mean_corrected"`).}

\item{donor_id_col}{Column name for donor IDs in `model_predictions`.}

\item{color_var}{Column name in `model_predictions` used to color points
(default `"age"`).}

\item{color_title}{Legend title for the color scale. If `NULL`, defaults to
`color_var`.}

\item{point_size}{Numeric point size.}

\item{point_alpha}{Numeric point transparency.}

\item{lm_linewidth}{Line width for the linear regression fit.}

\item{annotate_r_size}{Text size for the correlation annotation.}

\item{pad_frac}{Fraction of the data range used to pad shared x/y limits.}
}
\value{
A `ggplot` object, or `NULL` if fewer than two donors are present in
  the intersection after filtering.
}
\description{
Create a single residual-vs-residual scatter plot comparing two groups
(two cell types within a region, or two regions within a cell type).
Points correspond to donors present in both groups (intersection of donors).
The plot includes a y = x reference line, a linear fit, and an annotation of
the Pearson correlation computed on finite donor pairs.
}
