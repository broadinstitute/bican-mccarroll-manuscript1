% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential_expression.R
\name{continuous_by_factor_differential_expression}
\alias{continuous_by_factor_differential_expression}
\title{Fit region-specific slopes for a continuous variable using limma/voom + dream}
\usage{
continuous_by_factor_differential_expression(
  dge_cell,
  fixedVars,
  randVars,
  interaction_var = "region",
  continuous_var = "age",
  verbose = TRUE,
  n_cores = parallel::detectCores() - 2
)
}
\arguments{
\item{dge_cell}{A DGEList-like object (counts with \code{samples} metadata).}

\item{fixedVars}{Character vector of fixed effect variables to include
(do not include the continuous variable or its interaction term).}

\item{randVars}{Character vector of random effect variables to include
(random intercepts).}

\item{interaction_var}{Character string. The name of the categorical
factor variable in \code{dge_cell$samples} (e.g. "region").}

\item{continuous_var}{Character string. The name of the continuous
covariate variable in \code{dge_cell$samples} (e.g. "age").}

\item{verbose}{Logical. If \code{TRUE}, print progress messages.}

\item{n_cores}{Integer. Number of cores for parallel processing.}
}
\value{
A named list of \code{data.frame}s (one per level of the factor).
  Each element is the result of \code{variancePartition::topTable} for the corresponding
  per-level slope, with genes in rows and standard limma statistics.
}
\description{
This function estimates absolute slopes of a continuous covariate
(e.g. age) within each level of a categorical factor (e.g. brain region).
It constructs explicit per-level slope terms (`continuous_var * I(interaction_var==level)`)
in the design matrix, fits the model with `voomWithDreamWeights` and `dream`,
and returns one `topTable` per level with statistics for the slope.
}
\details{
This strategy avoids contrast matrices by creating explicit regressors
for each level of the factor multiplied by the continuous variable.
For example, with \code{continuous_var="age"} and \code{interaction_var="region"}
having levels \code{"CaH","NAC"}, the design will include columns
\code{age_regionCaH} and \code{age_regionNAC}. Their coefficients are the
estimated slopes of age in those regions.
}
