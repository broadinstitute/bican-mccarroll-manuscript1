% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mashR.R
\name{partition_mash_calls_by_component}
\alias{partition_mash_calls_by_component}
\title{Partition significant genes by mash mixture component families}
\usage{
partition_mash_calls_by_component(
  m,
  thresh = 0.05,
  keep_null = FALSE,
  map_labels = c("requested", "identity")
)
}
\arguments{
\item{m}{A fitted `mash` object (fit with `outputlevel = 2` so that
`m$posterior_weights` is available).}

\item{thresh}{Numeric scalar. Genes are considered for partitioning if
they have `ashr::get_lfsr(m) < thresh` in **any** condition.
Default: `0.05`.}

\item{keep_null}{Logical. If `FALSE` (default), drop the `"null"` family
from the output columns; if `TRUE`, keep it.}

\item{map_labels}{Character; one of `"requested"` or `"identity"`.
- `"identity"`: keep family names exactly as derived from the mixture
  (e.g., `"ED_PCA_1"`, `"equal_effects"`, `"identity"`, cell-type
  private components).
- `"requested"`: friendlier relabeling: keep raw cell-type names for
  private components, preserve each `ED_*` family as-is, map
  `"equal_effects"`/`"EE"` -> `"shared"`, and `"identity"` -> `"independent"`.}
}
\value{
A list with:
\describe{
  \item{assignment}{`data.frame(gene, label, post_weight)` - per-gene hard
  label (argmax family) and its collapsed posterior weight.}
  \item{counts}{`table` of hard-label counts (descending).}
  \item{fractions}{Named numeric vector: percentage for each label.}
  \item{weights_collapsed}{Matrix [genes x families] of **soft** weights,
  obtained by summing posterior weights across all scales/variants that
  belong to the same family. Row names are gene IDs.}
  \item{labels}{Character vector of family labels (column order of
  `weights_collapsed`).}
}
}
\description{
For genes with at least one condition passing an LFSR threshold, collapse
mash posterior weights across scales/variants into **component families**
that align with `mashr::get_estimated_pi(m)`, optionally relabel those
families, and assign each gene to the family with the largest collapsed
posterior weight (also returning the full soft weights).
}
