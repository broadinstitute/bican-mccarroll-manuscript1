% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mashR.R
\name{filter_mash_by_lfsr_effect}
\alias{filter_mash_by_lfsr_effect}
\title{Subset a mash fit by per-gene directional significance and effect size}
\usage{
filter_mash_by_lfsr_effect(m, lfsr_threshold = 0.05, effect_threshold = 0.05)
}
\arguments{
\item{m}{A fitted `mash` object.}

\item{lfsr_threshold}{Numeric scalar; directional error cutoff. Default `0.05`.}

\item{effect_threshold}{Numeric scalar; minimum absolute **posterior mean** on
the same scale as \code{ashr::get_pm(m)}. Default `0.05`.}
}
\value{
A `mash` object subset to the passing genes. If no genes pass, the
  original object is returned with a message.
}
\description{
Keep only genes that have **at least one condition** \(j\) with
\code{lfsr[i, j] < lfsr_threshold} **and** \code{abs(pm[i, j]) >= effect_threshold}.
Returns a new `mash` object containing just the selected genes (no refit).
}
\details{
Posterior summaries are obtained via the `ashr` generics
\code{ashr::get_pm} and \code{ashr::get_lfsr}. The function subsets:
\itemize{
  \item \code{m$result} matrices/vectors that are gene-aligned,
  \item \code{m$posterior_weights} (if present),
  \item \code{m$data} via \code{mashr::mash_set_data} to keep Bhat/Shat (and V/alpha).
}
Model-level slots (mixture, \eqn{\pi}, loglik) are kept unchanged.
}
