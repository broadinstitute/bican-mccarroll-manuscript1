% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction_residuals.R
\name{plot_jaccard_overlap_heatmap}
\alias{plot_jaccard_overlap_heatmap}
\title{Plot Jaccard overlap heatmap for aging programs within a slice}
\usage{
plot_jaccard_overlap_heatmap(
  all_models,
  mode = c("within_region", "within_cell_type"),
  cell_type = NULL,
  region = NULL,
  coef_thresh = 0,
  title = NULL,
  annotate_cells = TRUE,
  row_fontsize = 16,
  col_fontsize = 16,
  cell_fontsize = 16,
  row_order_names = NULL,
  column_order_names = NULL
)
}
\arguments{
\item{all_models}{A data.frame or data.table of model coefficients.
Must contain columns `cell_type`, `region`, `feature`, and `coef`.}

\item{mode}{Character scalar. Either `"within_region"` or `"within_cell_type"`.}

\item{cell_type}{Character scalar giving the cell type slice when
`mode = "within_cell_type"`.}

\item{region}{Character scalar giving the region slice when
`mode = "within_region"`.}

\item{coef_thresh}{Numeric threshold applied to `abs(coef)` when defining gene sets.}

\item{title}{Optional character scalar to use as the heatmap title. If `NULL`,
a default title derived from `mode` and the slice value is used.}

\item{annotate_cells}{Logical; if `TRUE`, annotate heatmap cells with Jaccard values.}

\item{row_fontsize}{Font size for heatmap row labels.}

\item{col_fontsize}{Font size for heatmap column labels.}

\item{cell_fontsize}{Font size for numeric cell annotations.}

\item{row_order_names}{Optional character vector of row names specifying the desired
row order. Names not present in the Jaccard matrix are ignored. If provided,
row clustering is disabled.}

\item{column_order_names}{Optional character vector of column names specifying the
desired column order. Names not present in the Jaccard matrix are ignored. If
provided, column clustering is disabled.}
}
\value{
A list with components:
\describe{
  \item{jaccard}{Numeric matrix of pairwise Jaccard coefficients.}
  \item{heatmap}{A `ComplexHeatmap::Heatmap` object. Draw with `ComplexHeatmap::draw()`.}
}
}
\description{
Compute pairwise Jaccard overlap of aging gene programs across groups
(cell types within a region, or regions within a cell type) and generate a
heatmap visualization.
}
\details{
Gene sets are defined per group using features with `abs(coef) > coef_thresh`.


To render the returned heatmap:
\preformatted{
out <- plot_jaccard_overlap_heatmap(...)
ComplexHeatmap::draw(out$heatmap, heatmap_legend_side = "right")
}
}
