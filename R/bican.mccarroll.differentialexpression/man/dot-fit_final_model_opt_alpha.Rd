% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/age_model_fit_core.R
\name{.fit_final_model_opt_alpha}
\alias{.fit_final_model_opt_alpha}
\title{Fit final elastic net model with alpha optimized by grid search}
\usage{
.fit_final_model_opt_alpha(X_all, y, alpha_grid, seed = NULL)
}
\arguments{
\item{X_all}{Numeric matrix (samples x genes), unscaled logCPM values.}

\item{y}{Numeric response vector (age), length = nrow(X_all).}

\item{alpha_grid}{Numeric vector of candidate alpha values.}

\item{seed}{Optional integer seed for reproducibility.}
}
\value{
A list with:
\itemize{
  \item \code{final_model}: data.frame with columns \code{feature}, \code{coef},
    \code{mean_train}, \code{sd_train}, \code{intercept}.
  \item \code{final_alpha}: selected alpha.
  \item \code{final_lambda}: selected \code{lambda.min}.
}
}
\description{
Internal helper to fit a final model on all samples in \code{X_all}. Performs
a grid search over \code{alpha_grid}; for each alpha, selects \code{lambda.min}
by \code{glmnet::cv.glmnet()}, then chooses the alpha with lowest CV loss and
refits a final \code{glmnet} model at that (alpha, lambda).
}
\keyword{internal}
