% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/createDGEList.R
\name{add_donor_annotations}
\alias{add_donor_annotations}
\title{Add Donor-Level Annotations to a DGEList}
\usage{
add_donor_annotations(
  dge_merged,
  cell_metadata,
  metadata_columns,
  add_counts = TRUE
)
}
\arguments{
\item{dge_merged}{A \code{DGEList} object with a \code{donor} column in \code{dge$samples}.}

\item{cell_metadata}{A data frame of per-cell metadata used to extract donor-level summaries.}

\item{metadata_columns}{Character vector of columns to extract and merge into the \code{samples} data frame.}

\item{add_counts}{Logical; if \code{TRUE}, adds a column \code{n_cells} with the number of nuclei per donor (num_nuclei)}
}
\value{
A \code{DGEList} object with additional donor-level columns in \code{dge$samples}.
}
\description{
Merges donor-level metadata into the \code{samples} data frame of a \code{DGEList} object
by matching donor identifiers to aggregated values in a cell-level metadata table.
}
\keyword{internal}
