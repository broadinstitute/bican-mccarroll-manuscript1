% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compareGeneFiltering.R
\name{compare_all_age_de_runs}
\alias{compare_all_age_de_runs}
\title{Compare age differential expression results across filtering trajectories}
\usage{
compare_all_age_de_runs(
  data_dir,
  outDir = NULL,
  filter_levels = c(0, 1, 2, 3, 4),
  fdr_cutoff = 0.05,
  clustering_min_genes = 100,
  num_clusters = 4
)
}
\arguments{
\item{data_dir}{Character scalar. Base directory containing DE results
organized by filtering level (e.g., \code{LEVEL_0}, \code{LEVEL_1}, ...).}

\item{outDir}{Character scalar. Output directory where the summary PDF will
be written. If \code{NULL}, no output file is written and the aggregated
data frame is returned.}

\item{filter_levels}{Integer vector. Filtering levels to compare. The first
value is treated as the baseline level, and each subsequent value is
compared against it. Default is \code{c(0, 1, 2, 3, 4)}.}

\item{fdr_cutoff}{Numeric scalar. False discovery rate (FDR) threshold used
within \code{compare_age_de_runs()} when computing per-cell-type summaries.
Default is \code{0.05}.}

\item{clustering_min_genes}{Integer scalar. Minimum number of significant
genes in the baseline run (\code{num_genes_significant_old}) required for a
cell type to be included in trajectory clustering. Default is \code{100}.
Only used if \code{outDir} is not \code{NULL}.}

\item{num_clusters}{Integer scalar. Number of clusters to use in
\code{cluster_filtering_trajectories()}. Default is \code{4}.  Only used
if \code{outDir} is not \code{NULL}.}
}
\description{
Compares age-related differential expression (DE) results across a sequence
of filtering stringency levels, treating the first entry of
\code{filter_levels} as the baseline and comparing it to each subsequent
level. For each adjacent comparison \eqn{(LEVEL_{base}, LEVEL_{k})}, the
function calls \code{compare_age_de_runs()} to compute concordance metrics
across cell types (e.g., logFC and FDR correlations and the fraction of
discoveries retained), then aggregates results across comparisons.
}
\details{
After aggregating, the function:
\itemize{
  \item Plots per-cell-type discovery trajectories across comparison levels.
  \item Filters to cell types with at least \code{clustering_min_genes}
        significant genes in the baseline run.
  \item Clusters discovery trajectories using \code{cluster_filtering_trajectories()}
        (currently with \code{K = 4}).
  \item Writes a PDF summary containing the trajectory plots and additional
        diagnostics relating discovery reduction to baseline signal.
}

The function assumes a standardized directory layout for each filtering level:
\preformatted{
  data_dir/LEVEL_<level>/sex_age/cell_type/
}

Output is written to \code{outDir} as \code{"compare_de_age_all_levels_summary.pdf"}.
}
