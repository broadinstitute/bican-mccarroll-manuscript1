% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction_residuals.R
\name{.plot_residual_corr_heatmap_matrix}
\alias{.plot_residual_corr_heatmap_matrix}
\title{Plot heatmap of residual correlations}
\usage{
.plot_residual_corr_heatmap_matrix(
  res_mat,
  title = NULL,
  annotate_cells = TRUE,
  row_fontsize = 9,
  col_fontsize = 9,
  cell_fontsize = 9
)
}
\arguments{
\item{res_mat}{A numeric matrix of residuals with donors in rows and
variables (e.g., regions or cell types) in columns.}

\item{annotate_cells}{Logical; if `TRUE`, overlay each heatmap cell with
the corresponding correlation value rounded to two decimals.}

\item{row_fontsize}{Numeric font size for row labels.}

\item{col_fontsize}{Numeric font size for column labels.}

\item{cell_fontsize}{Numeric font size for correlation annotations inside cells.}

\item{cellType}{Optional string used to prefix the heatmap title.}
}
\value{
A `ComplexHeatmap::Heatmap` object.
}
\description{
Compute the pairwise Pearson correlation matrix from a residual matrix and
display it as a clustered heatmap using `ComplexHeatmap`. Rows and columns
correspond to the variables (e.g., regions or cell types) in `res_mat`.
}
\details{
Optionally annotates each heatmap cell with the numeric correlation value.


Correlations are computed using `stats::cor()` with
`use = "pairwise.complete.obs"`. Rows and columns are hierarchically
clustered. The color scale is fixed to the range [-1, 1] with blue for
negative correlations, white for zero, and red for positive correlations.
}
\examples{
# res_mat: donors x regions residual matrix
ht <- plot_residual_corr_heatmap(
    res_mat = res_mat,
    cellType = "astrocyte",
    annotate_cells = TRUE
)
ComplexHeatmap::draw(ht)

}
