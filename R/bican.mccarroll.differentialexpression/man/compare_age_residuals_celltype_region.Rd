% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction_residuals.R
\name{compare_age_residuals_celltype_region}
\alias{compare_age_residuals_celltype_region}
\title{Compare donor age residuals across cell types and regions}
\usage{
compare_age_residuals_celltype_region(
  model_file,
  prediction_file,
  cellTypeListFile = NULL,
  value_var = "resid_mean",
  exclude_donor_age_range = c(),
  out_pdf_file = NULL
)
}
\arguments{
\item{model_file}{Path to a file containing serialized age models (passed to
\code{load_models()}).}

\item{prediction_file}{Path to a file containing serialized model predictions
(passed to \code{load_model_predictions()}).}

\item{cellTypeListFile}{Optional path to a cell type list file used by
\code{load_model_predictions()} and \code{load_models()} to restrict or
order cell types.}

\item{value_var}{Character scalar naming the column in the predictions table
to compare (default \code{"resid_mean"}). Examples include
\code{"resid_mean"} or \code{"resid_mean_corrected"} if available.}

\item{exclude_donor_age_range}{Numeric vector of length 2 specifying an age
interval \code{c(age_min, age_max)}. Donors with ages in the closed interval
\code{[age_min, age_max]} are excluded. If not length 2, no exclusion is
performed.}

\item{out_pdf_file}{Optional output PDF filepath. If provided, opens a PDF
device with \code{width = 11} and \code{height = 11}, writes plots, and
closes the device.}
}
\value{
Invisibly returns \code{NULL}. This function is called for its side
  effects (plot generation and optional PDF output).
}
\description{
Loads saved age-prediction outputs (models and per-donor predictions) and
generates diagnostic plots comparing donor-level residuals (or other
donor-level summary values) across:
\itemize{
  \item cell types within each region, and
  \item regions within each cell type.
}
}
\details{
For each region, donor-level values are spread into a donor-by-cell-type
matrix and pairwise relationships are plotted (via
\code{plot_residuals_for_subset()}). The same analysis is repeated for each
cell type across regions.

Optionally excludes donors whose ages fall within a specified closed interval
\code{[age_min, age_max]} prior to plotting.

If \code{out_pdf_file} is provided, plots are written to a PDF device and the
device is closed on exit.
}
