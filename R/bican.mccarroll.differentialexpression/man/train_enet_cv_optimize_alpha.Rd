% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/age_model_fit_core.R
\name{train_enet_cv_optimize_alpha}
\alias{train_enet_cv_optimize_alpha}
\title{Train elastic net age model with K-fold cross-validation (alpha grid search)}
\usage{
train_enet_cv_optimize_alpha(
  dge_train,
  k_fold_index = NULL,
  age_col = "age",
  donor_col = "donor",
  alpha_grid = seq(0, 1, by = 0.1),
  compute_oof = TRUE,
  seed = 1,
  verbose = FALSE
)
}
\arguments{
\item{dge_train}{A \code{DGEList} with donor-level samples and ages stored in
\code{dge_train$samples}.}

\item{k_fold_index}{Named integer vector mapping donor IDs to fold numbers
1..K. Required when \code{compute_oof = TRUE}. Ignored when
\code{compute_oof = FALSE}.}

\item{age_col}{Column name in \code{dge_train$samples} containing donor age.}

\item{donor_col}{Column name in \code{dge_train$samples} containing donor IDs.}

\item{alpha_grid}{Numeric vector of candidate alpha values.}

\item{compute_oof}{Logical; if \code{TRUE}, compute OOF predictions/metrics
using \code{k_fold_index}. If \code{FALSE}, skip OOF computation.}

\item{seed}{Integer seed for reproducibility.}

\item{verbose}{Logical; if \code{TRUE}, log progress messages.}
}
\value{
A list with:
\itemize{
  \item \code{per_fold_metrics}: data.frame of metrics per fold (or \code{NULL}
    if \code{compute_oof = FALSE}).
  \item \code{overall_metrics}: metrics on OOF predictions across all donors
    (or \code{NULL} if \code{compute_oof = FALSE}).
  \item \code{donor_age_predictions}: OOF prediction data.frame with columns
    \code{donor}, \code{age}, \code{pred}, \code{fold} (or \code{NULL} if
    \code{compute_oof = FALSE}).
  \item \code{fold_models}: list of per-fold model coefficient data.frames
    (or \code{NULL} if \code{compute_oof = FALSE}).
  \item \code{model_df}: combined long-form coefficient data.frame across folds
    (or \code{NULL} if \code{compute_oof = FALSE}).
  \item \code{final_model}: data.frame representing the final model fit on all
    provided data, including scaling parameters and intercept.
  \item \code{final_alpha}: selected alpha for the final model.
  \item \code{final_lambda}: selected \code{lambda.min} for the final model.
}
}
\description{
Trains an elastic net age prediction model using donor-level K-fold
cross-validation for out-of-fold (OOF) performance estimation, while selecting
\code{alpha} by grid search. For each fold, \code{alpha} and \code{lambda} are
selected using training donors only, then a fold model is fit and evaluated on
held-out donors.
}
\details{
The final model is always refit on all provided samples after selecting the
best \code{alpha} and \code{lambda} on the full dataset.

Set \code{compute_oof = FALSE} to skip fold-based OOF prediction and return
only the final refit model (useful for repeated Monte Carlo splits).
}
