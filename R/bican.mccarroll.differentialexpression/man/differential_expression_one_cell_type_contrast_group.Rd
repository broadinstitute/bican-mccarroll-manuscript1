% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential_expression.R
\name{differential_expression_one_cell_type_contrast_group}
\alias{differential_expression_one_cell_type_contrast_group}
\title{Differential expression for one cell type with optional continuous-by-factor interactions}
\usage{
differential_expression_one_cell_type_contrast_group(
  dge_cell,
  fixedVars,
  randVars,
  contrast_defs,
  contrast_group = "age",
  interaction_var = "region",
  verbose = TRUE,
  n_cores = parallel::detectCores() - 2
)
}
\arguments{
\item{dge_cell}{A `DGEList` with counts and sample metadata in
`dge_cell$samples`.}

\item{fixedVars}{`character()`. Fixed effects to include. The function will
move `contrast_group` to the front and may append `contrast_group:interaction_var`.}

\item{randVars}{`character()`. Random-effect grouping variables. Terms with
insufficient replication are pruned.}

\item{contrast_defs}{`data.frame` describing contrasts. Must contain columns:
`contrast_name`, `variable`, `reference_level`, `comparison_level`, and
`baseline_region`. The `baseline_region` entry for `variable == contrast_group`
is used as the interaction baseline when `interaction_var` is not `NULL`.}

\item{contrast_group}{`character(1)`. contrast_name to test (e.g., `"age"`).}

\item{interaction_var}{`character(1)` or `NULL`. Factor to interact with
`contrast_group` (default `"region"`). If `NULL`, no interaction is added.
If non-`NULL`, a baseline level must be supplied via
`contrast_defs$baseline_region` where `variable == contrast_group`.}

\item{verbose}{`logical(1)`. Verbose logging.}

\item{n_cores}{`integer(1)`. Worker count for `BiocParallel::MulticoreParam`.}
}
\description{
Fit a `variancePartition::dream` model for one cell type, optionally adding an
interaction between a **continuous** contrast variable (e.g., `age`) and a
multi-level factor (default `region`). If an interaction is requested and a
baseline level is provided in `contrast_defs`, the function:
(1) enforces treatment coding for the interaction factor with that baseline,
(2) adds the interaction term to the fixed effects,
(3) returns topTables for the main continuous effect (renamed to
`contrast_group:interaction_var<baseline>`), the per-level interaction
differences (`contrast_group:interaction_var<level>`), and an additional
data frame of absolute per-level effects (`contrast_group_absolute_effects`).
}
\note{
In this version, interaction terms are supported **only for continuous
  variables**. For categorical contrast variables (e.g., multi-level treatment),
  interaction testing is not constructed here.
}
