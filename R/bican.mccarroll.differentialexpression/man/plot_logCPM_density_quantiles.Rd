% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/variancePartition.R
\name{plot_logCPM_density_quantiles}
\alias{plot_logCPM_density_quantiles}
\title{Plot log-CPM density with quantile ribbons and return filtered DGEList}
\usage{
plot_logCPM_density_quantiles(
  dge,
  cpm_cutoff = 0.5,
  logCPM_xlim = c(-5, 15),
  lower_quantile = 0.05,
  upper_quantile = 0.95,
  quantile_steps = 5,
  min_samples = 1,
  fraction_samples = 0
)
}
\arguments{
\item{dge}{A \code{DGEList} with raw counts and sample metadata.}

\item{cpm_cutoff}{Numeric CPM threshold. Genes with CPM \eqn{\ge} this
value in at least one sample are kept for density estimation.}

\item{logCPM_xlim}{Numeric length-2 vector giving the x-axis limits for
log-CPM when computing densities and plotting.}

\item{lower_quantile}{Numeric in (0, 0.5]. Currently not used; quantile
ribbons are drawn from 0.5 up to \code{upper_quantile}.}

\item{upper_quantile}{Numeric in [0.5, 1). Upper probability for the
outermost quantile ribbon.}

\item{quantile_steps}{Integer \eqn{\ge} 1. Number of equally spaced
quantile levels between 0.5 and \code{upper_quantile}.}
}
\value{
A list with two elements:
\itemize{
  \item \code{filtered_dge}: the input \code{DGEList} filtered to genes
        passing \code{cpm_cutoff} (library sizes not preserved).
  \item \code{plot}: a \code{ggplot2} object showing quantile ribbons of
        the per-sample log-CPM densities and the mean density curve.
}
}
\description{
Computes per-sample kernel density estimates of log-CPM expression,
overlays quantile ribbons across samples, and draws the across-sample
mean density. Genes are first filtered by a CPM cutoff, and the function
returns both the filtered \code{DGEList} and the \code{ggplot2} object.
}
\details{
For each sample, log-CPM is computed via \code{edgeR::cpm(dge, log = TRUE)}.
Genes are filtered using CPM on the raw scale. Densities are evaluated on a
regular grid defined by \code{logCPM_xlim}. Quantile ribbons are computed
across samples at symmetric lower/upper probabilities (lower = 1 - q,
upper = q) for \code{q} in \code{seq(0.5, upper_quantile, length.out = quantile_steps)}.
A message with the gene counts pre- and post-filtering is logged via
\code{logger::log_info()}.
}
