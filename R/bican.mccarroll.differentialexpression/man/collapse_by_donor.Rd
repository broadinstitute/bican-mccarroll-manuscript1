% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/donor_age_prediction.R
\name{collapse_by_donor}
\alias{collapse_by_donor}
\title{Collapse counts in a DGEList to one column per donor}
\usage{
collapse_by_donor(
  dge,
  donor_col = "donor",
  keep_cols = character(0),
  sum_cols = character(0)
)
}
\arguments{
\item{dge}{A \code{DGEList} containing raw counts and a \code{samples} data.frame.}

\item{donor_col}{Character scalar giving the column in \code{dge$samples}
that identifies the donor for each sample. Each donor must appear in one
or more rows.}

\item{keep_cols}{Character vector of column names in \code{dge$samples}
to retain in the output. For each donor, the function checks that these
columns have exactly one unique (non-NA) value across all donor samples.
An error is thrown if a column has multiple distinct values within a donor.}

\item{sum_cols}{Character vector of numeric columns in \code{dge$samples} to
sum within donor (e.g. \code{"num_nuclei"}).}
}
\value{
A new \code{DGEList} where:
  \itemize{
    \item \code{$counts} is a matrix of gene-by-donor integer counts
      summed across all samples of each donor.
    \item \code{$samples} contains one row per donor, restricted to
      \code{keep_cols}, plus standard edgeR fields \code{group},
      \code{lib.size}, and \code{norm.factors}.
  }
  Library sizes are recomputed as column sums of the collapsed counts,
  and normalization factors are set to 1.
}
\description{
Aggregates raw counts in an edgeR \code{DGEList} so that each donor
contributes a single column whose counts are the sum of all samples
belonging to that donor. This is useful when a donor has multiple
sequencing libraries or replicates and you need one observation per donor
for downstream modeling.
}
