% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mashR.R
\name{make_mash_inputs}
\alias{make_mash_inputs}
\title{Build Bhat/Shat/Tstat/FDR matrices from per-cell-type DE tables}
\usage{
make_mash_inputs(
  lst,
  coef_col = "logFC",
  t_col = "t",
  p_col = "P.Value",
  fdr_col = "adj.P.Val",
  gene_mode = c("union", "intersect"),
  big_se = 1e+06,
  fill_missing_fdr = NA_real_
)
}
\arguments{
\item{lst}{Named `list` of data frames (one per cell type). Each must have
row names as gene IDs and the columns specified by `coef_col`, `t_col`,
and `fdr_col`.}

\item{coef_col}{Character scalar. Column name for the effect size (beta),
for example `"logFC"`. Default `"logFC"`.}

\item{t_col}{Character scalar. Column name for the t-statistic, for example `"t"`.
Default `"t"`.}

\item{p_col}{Character scalar. Column name for the p-value, for example `"P.Value"`.}

\item{fdr_col}{Character scalar. Column name for the FDR or q-value,
for example `"adj.P.Val"`. Default `"adj.P.Val"`.}

\item{gene_mode}{One of `c("union", "intersect")`. Use `"union"` to include
all genes observed in any table (missing entries are replaced with
`beta = 0` and `SE = big_se`). Use `"intersect"` to keep only genes present
in every table. Default `"union"`.}

\item{big_se}{Numeric scalar. Standard error to use when filling missing or
invalid entries. A very large value ensures such entries contribute ~0
information to mash. Default `1e6`.}

\item{fill_missing_fdr}{Numeric scalar used to fill missing FDR entries in
the returned `FDR` matrix (for plotting or logic only; not used by mash).
Default `NA_real_`.}
}
\value{
A list with components:
\itemize{
  \item `Bhat` - matrix [genes x cell types] of betas.
  \item `Shat` - matrix [genes x cell types] of standard errors (`abs(beta / t)`).
  \item `Tstat` - matrix [genes x cell types] of moderated t-statistics.
  \item `FDR`  - matrix [genes x cell types] of FDR values.
  \item `missing_mask` - logical matrix [genes x cell types] indicating where
        input was missing or invalid and replaced by `beta = 0, SE = big_se`.
}
}
\description{
Construct matrices for `mashr` from a list of differential expression tables
(one per cell type or condition). You can choose to include the **union** of all
genes seen across tables (filling missing entries with beta = 0 and a very large
SE so they have no influence on mash), or restrict to the **intersection**
(genes present in every table).

For each table, the function reads a coefficient column (for example, `logFC`),
a t-statistic column (for example, `t`), and an FDR column (for example, `adj.P.Val`), and
computes `Shat = abs(beta / t)` (so `t = beta / se` as in limma).
}
\details{
- With `gene_mode = "union"`, the function guarantees rectangular matrices by
  inserting neutral placeholders for missing cells (0, `big_se`). This allows
  mash to ingest more genes without biasing fits.
- With `gene_mode = "intersect"`, all retained genes have entries in every
  column (aside from pathological `t = 0`; those are still treated as missing
  and assigned `SE = big_se`).
}
