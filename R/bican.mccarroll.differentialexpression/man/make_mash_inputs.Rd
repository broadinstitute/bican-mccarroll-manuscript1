% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mashR.R
\name{make_mash_inputs}
\alias{make_mash_inputs}
\title{Build Bhat/Shat/FDR matrices from per–cell-type DE tables}
\usage{
make_mash_inputs(
  lst,
  coef_col = "logFC",
  t_col = "t",
  fdr_col = "adj.P.Val",
  gene_mode = c("union", "intersect"),
  big_se = 1e+06,
  fill_missing_fdr = NA_real_
)
}
\arguments{
\item{lst}{Named `list` of data frames (one per cell type). Each must have
rownames as gene IDs and the columns specified by `coef_col`, `t_col`,
and `fdr_col`.}

\item{coef_col}{Character scalar. Column name for the effect size (beta),
e.g. `"logFC"`. Default `"logFC"`.}

\item{t_col}{Character scalar. Column name for the t-statistic, e.g. `"t"`.
Default `"t"`.}

\item{fdr_col}{Character scalar. Column name for the FDR/q-value,
e.g. `"adj.P.Val"`. Default `"adj.P.Val"`.}

\item{gene_mode}{One of `c("union","intersect")`. Use `"union"` to include
all genes observed in any table (missing entries are replaced with
`beta=0` and `SE=big_se`). Use `"intersect"` to keep only genes present
in **every** table. Default `"union"`.}

\item{big_se}{Numeric scalar. Standard error to use when filling missing or
invalid entries. A very large value ensures such entries contribute ~0
information to mash. Default `1e6`.}

\item{fill_missing_fdr}{Numeric scalar used to fill missing FDR entries in
the returned `FDR` matrix (for plotting/logic only; **not** used by mash).
Default `NA_real_`.}
}
\value{
A list with components:
\itemize{
  \item `Bhat` — matrix [genes × cell types] of betas.
  \item `Shat` — matrix [genes × cell types] of standard errors (`|beta/t|`).
  \item `FDR`  — matrix [genes × cell types] of FDR values (filled with
        `fill_missing_fdr` where absent).
  \item `missing_mask` — logical matrix [genes × cell types] indicating where
        input was missing/invalid and got replaced by `beta=0, SE=big_se`.
}
}
\description{
Construct matrices for `mashr` from a list of differential expression tables
(one per cell type/condition). You can choose to include the **union** of all
genes seen across tables (filling missing entries with beta=0 and a very large
SE so they have no influence on mash), or restrict to the **intersection**
(genes present in every table).

For each table, the function reads a coefficient column (e.g. `logFC`),
a t-statistic column (e.g. `t`), and an FDR column (e.g. `adj.P.Val`), and
computes `Shat = |beta / t|` (so `t = beta / se` as in limma).
}
\details{
- With `gene_mode = "union"`, the function guarantees rectangular matrices by
  inserting neutral placeholders for missing cells (0, `big_se`). This is
  a common trick so that mash can ingest more genes without biasing fits.
- With `gene_mode = "intersect"`, all retained genes have entries in every
  column (aside from pathological `t=0`; those are still treated as missing
  and assigned `SE=big_se`).
}
