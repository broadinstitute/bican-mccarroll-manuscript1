% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/select_marker_genes.R
\name{select_marker_genes}
\alias{select_marker_genes}
\title{Select marker genes for each cell type (DGEList interface)}
\usage{
select_marker_genes(
  dgeList,
  high_expression_threshold = 10,
  fold_change = 10,
  markerGeneReportFile = NULL
)
}
\arguments{
\item{dgeList}{An \code{edgeR::DGEList} with one observation per donor/cell type
(or an object accepted by \code{simplify_dge_for_marker_genes()}), and with
\code{dgeList$samples$cell_type} and \code{dgeList$samples$donor} present.}

\item{high_expression_threshold}{CPM threshold used to define "expressed in
target" for donor-level metrics.}

\item{fold_change}{Minimum per-donor fold change (target / other) required to
count a donor as passing the fold-change criterion.}

\item{markerGeneReportFile}{Optional output TSV path. If \code{NULL}, no file
is written.}
}
\value{
A data frame of marker-gene candidates across all target cell types.
  The returned data frame includes at least:
  \itemize{
    \item \code{gene}
    \item \code{target_cell_type}
    \item \code{closest_cell_type} (worst-case comparator)
    \item \code{median_cpm_target}
    \item \code{median_fold_change_across_donors}
    \item \code{n_donors_expr}
    \item \code{n_donors_fc_pass}
    \item \code{n_donors_pass}
    \item \code{n_donors_fail}
  }
}
\description{
Identifies marker genes for each cell type in a donor-collapsed \code{edgeR}
\code{DGEList}. For a given target cell type and gene, CPM values are compared
against each other cell type using only donors present in both cell types.
Donor-level pass/fail metrics are computed using:
\itemize{
  \item target CPM > \code{high_expression_threshold}
  \item (target CPM / other CPM) > \code{fold_change}
}
The worst-case comparator cell type is selected per gene by maximizing the
number of failing donors; ties are broken by the lowest median fold change.
}
\details{
If \code{markerGeneReportFile} is provided, the results are written as a
tab-delimited file with a leading comment line beginning with \code{#} that
records \code{high_expression_threshold} and \code{fold_change}.
}
