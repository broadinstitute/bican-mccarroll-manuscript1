% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/load_data_differential_expression.R
\name{gather_de_results}
\alias{gather_de_results}
\title{Gather differential expression results and construct mash-ready matrices}
\usage{
gather_de_results(
  in_dir,
  file_pattern = "age",
  cellTypeListFile = NULL,
  fdrThreshold = 0.01
)
}
\arguments{
\item{in_dir}{Character scalar. Directory containing DE result files.}

\item{file_pattern}{Character scalar. Pattern used to select DE files within
`in_dir` (passed to `list.files(..., pattern = file_pattern)`). Default `"age"`.}

\item{cellTypeListFile}{Character scalar or `NULL`. Path to a text file with one
cell type per line used to filter the DE inputs. If provided, entries are
matched as prefixes of file basenames after appending `paste0("_", file_pattern)`.
Default `NULL`.}

\item{fdrThreshold}{Numeric scalar. Genes are retained if they have
`FDR < fdrThreshold` in at least one condition. Default `0.01`.}
}
\value{
A list of mash input matrices after filtering:
\itemize{
  \item `Bhat` - numeric matrix [genes x conditions] of effect sizes.
  \item `Shat` - numeric matrix [genes x conditions] of standard errors.
  \item `Tstat` - numeric matrix [genes x conditions] of t-statistics.
  \item `P_val` - numeric matrix [genes x conditions] of p-values (if present in inputs).
  \item `FDR` - numeric matrix [genes x conditions] of FDR values.
  \item `missing_mask` - logical matrix [genes x conditions] indicating filled/missing entries.
  \item `idxPassFDRAny` - integer vector of row indices (in the unfiltered union matrices)
        that passed the FDR criterion.
}
}
\description{
Read per-condition (or per-cell-type) differential expression (DE) result tables
from `in_dir`, optionally restrict to a provided list of cell types, and
construct mash-compatible matrices (`Bhat`, `Shat`, `Tstat`, `FDR`, etc.) using
`make_mash_inputs()` with `gene_mode = "union"`.

The function then filters the matrices to genes that pass an FDR threshold in
at least one condition (row-wise across the `FDR` matrix).

Gene x conditions that were not tested (missing in the input DE tables) are
flagged by the `missing_mask` output matrix.  Those entries have been filled with
neutral values (beta = 0, SE = large value) so they do not influence mash results.
}
