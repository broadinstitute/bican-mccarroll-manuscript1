% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identify_ctp_outliers.R
\name{identify_ctp_outliers_one_region}
\alias{identify_ctp_outliers_one_region}
\title{Identify outliers in CTP data for one brain region based on low nuclei counts, unexpected neuron fractions, and conformity scores.}
\usage{
identify_ctp_outliers_one_region(
  ctp_region_df,
  cell_type_col,
  conformity_threshold = 3.75,
  conformity_method = "pearson",
  neuron_ctp_df = NULL,
  unexpected_neuron_types = NULL,
  neuron_fraction_threshold = 0.2
)
}
\arguments{
\item{ctp_region_df}{Dataframe of CTP data for one brain region (one row per cell type).}

\item{cell_type_col}{Name of the column in ctp_region_df that contains the cell type label.}

\item{conformity_threshold}{Threshold for modified Z-score to identify conformity outliers (default 3.75).}

\item{conformity_method}{Correlation method to use for conformity scores (default "pearson")}

\item{neuron_ctp_df}{Optional dataframe of neuron-only CTP data for the same brain region (one row per neuron cell type).}

\item{unexpected_neuron_types}{Optional vector of neuron types considered unexpected for the brain region.}

\item{neuron_fraction_threshold}{Threshold for fraction of unexpected neurons above which a sample is considered an outlier (default 0.2).}
}
\value{
Dataframe with sample_id, total_nuclei, z_log10_total_nuclei, nuclei_count_outlier, total_neurons, unexpected_neuron_fraction, unexpected_neuron_outlier, conformity_score, modified_z_conformity_score, conformity_outlier, and overall_outlier (TRUE/FALSE).
}
\description{
Identify outliers in CTP data for one brain region based on low nuclei counts, unexpected neuron fractions, and conformity scores.
}
