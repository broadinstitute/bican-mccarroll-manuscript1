% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/de_age_sex_plots.R
\name{plot_donor_gex_age_heatmap}
\alias{plot_donor_gex_age_heatmap}
\title{Donor-level GEX heatmap ordered by donor age
(originally plot_donor_gex_age_heatmap)}
\usage{
plot_donor_gex_age_heatmap(
  metacells,
  gs,
  donor_ages,
  gs_gaps = NULL,
  cluster_gs = FALSE,
  transpose = FALSE
)
}
\arguments{
\item{metacells}{Numeric matrix (or Matrix) with rows = genes and columns = donors.
Column names must be donor IDs that match names(donor_ages).}

\item{gs}{Character vector of gene symbols to plot.}

\item{donor_ages}{Named numeric vector of donor ages (names are donor IDs).}

\item{gs_gaps}{Optional integer vector giving gap positions between gene groups.}

\item{cluster_gs}{Logical; if TRUE, cluster genes using Spearman correlation.}

\item{transpose}{Logical; if TRUE, plot donors as rows and genes as columns.}
}
\value{
Invisibly returns NULL.
}
\description{
Plots a heatmap of donor-level expression (TPM) for a gene set, with donors
implicitly ordered by column order in `metacells` and decade boundaries
indicated by gaps.
}
\details{
The expression is scaled per gene using the 10th and 90th percentiles across donors:
values are shifted by p10, divided by (p90 - p10), and clipped to [0, 1].
}
