% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/de_age_sex_plots.R
\name{write_de_lite}
\alias{write_de_lite}
\title{Write lightweight DE outputs (summary + top up/down gene tables)}
\usage{
write_de_lite(
  de_dt,
  metacell_summary,
  donor_ages,
  cell_type_use,
  region_use,
  out_name,
  out_dir,
  n_top = 200,
  fdr_thresh = 0.05
)
}
\arguments{
\item{de_dt}{data.table containing DE results with at least columns:
gene, cell_type, log_fc, log_fc_se, t, adj_p_val.}

\item{metacell_summary}{data.table containing per-gene expression summaries
with at least columns: gene, cell_type, region, n_donors, and
median_30 ... median_90.}

\item{donor_ages}{Named numeric vector of donor ages (used for summary text).}

\item{cell_type_use}{Character scalar; cell type to extract.}

\item{region_use}{Character scalar; region to extract expression medians from.}

\item{out_name}{Basename for output files (no extension).}

\item{out_dir}{Output directory path.}

\item{n_top}{Maximum number of top up and top down genes to write.}

\item{fdr_thresh}{Adjusted p-value threshold.}
}
\value{
Invisibly returns a list with file paths and the two output tables.
}
\description{
Writes three files:
1) A plain-text summary of inputs and DE results
2) A TSV of top upregulated genes (by t-statistic)
3) A TSV of top downregulated genes (by t-statistic)
}
\details{
The DE table is subset to `cell_type_use`. Expression summaries are taken
from `metacell_summary` for the specified `cell_type_use` and `region_use`.
}
