% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combine_expression_across_cell_types.R
\name{combine_expression_across_cell_types}
\alias{combine_expression_across_cell_types}
\title{Combine gene expression TPM across cell types into a single matrix}
\usage{
combine_expression_across_cell_types(
  eqtl_dir,
  region_cell_type_path,
  output_path = NULL
)
}
\arguments{
\item{eqtl_dir}{Character scalar.  Path to the eQTL results directory
(e.g. \code{.../LEVEL_3}).  Each cell type subdirectory should contain
a file named \code{<ct>__<reg>.gene_expression_tpm.bed.gz}.}

\item{region_cell_type_path}{Character scalar.  Path to a tab-delimited
file with columns \code{cell_type} and \code{region}.}

\item{output_path}{Character scalar or \code{NULL}.  If non-NULL, the
combined matrix is written to this path as a tab-delimited file.}
}
\value{
A \code{data.table} with column \code{pid} (gene ID) and one
  column per sample per cell type, named \code{<sample>_<ct>__<reg>}.
}
\description{
For each cell type / region group, reads the per-sample gene expression
TPM BED file, appends the cell type name to sample column headers, and
joins all cell types into one wide matrix keyed by gene ID (\code{pid}).
}
