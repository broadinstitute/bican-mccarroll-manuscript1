% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/index_snp_slope_matrix.R
\name{get_index_snp_slope_matrix_with_median_impute}
\alias{get_index_snp_slope_matrix_with_median_impute}
\title{Select index SNPs per gene and build a sign-adjusted, median-imputed slope matrix}
\usage{
get_index_snp_slope_matrix_with_median_impute(
  slope_matrix_path,
  min_non_na = 3,
  output_path = NULL
)
}
\arguments{
\item{slope_matrix_path}{Character scalar.  Path to the slope matrix file
(output of \code{\link{get_slope_matrix}}), with columns
\code{phenotype_id}, \code{variant_id}, and one slope column per
cell type / region.}

\item{min_non_na}{Integer scalar.  Minimum number of non-NA slope values
required to retain a gene.  Default \code{3}.}

\item{output_path}{Character scalar or \code{NULL}.  If non-NULL, the result
table is written to this path as a tab-delimited file.}
}
\value{
A \code{data.table} with columns \code{phenotype_id},
  \code{variant_id}, and one sign-adjusted, imputed slope column per
  cell type / region.
}
\description{
Starting from the full slope matrix (eGene-variant pairs x cell type/region),
this function:
\enumerate{
  \item Selects one index variant per gene â€” the variant with the largest
        absolute slope across all cell types.
  \item Adjusts signs so the cell type with the largest absolute slope is
        always positive (ensures consistent orientation across genes).
  \item Filters to genes with at least \code{min_non_na} non-NA slope values.
  \item Imputes remaining NA values with the row (gene) median.
}
}
