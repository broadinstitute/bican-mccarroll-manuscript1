% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_gene_snp.R
\name{plot_gene_snp}
\alias{plot_gene_snp}
\title{Plot gene expression by SNP genotype across cell types}
\usage{
plot_gene_snp(
  gene,
  chr,
  pos,
  vcf_path,
  expression_path,
  output_path = NULL,
  width = 2600,
  height = 350,
  res = 100
)
}
\arguments{
\item{gene}{Character scalar.  Gene symbol (e.g. \code{"CEP112"}).}

\item{chr}{Character scalar.  Chromosome (e.g. \code{"chr17"}).}

\item{pos}{Integer scalar.  Genomic position (1-based).}

\item{vcf_path}{Character scalar.  Path to the indexed VCF/BCF file.}

\item{expression_path}{Character scalar.  Path to the combined gene
expression TPM TSV (output of
\code{\link{combine_expression_across_cell_types}}).  First column is
\code{pid} (gene ID); remaining columns are
\code{<donor>_<celltype>__<region>}.}

\item{output_path}{Character scalar or \code{NULL}.  If non-NULL, the
plot is saved to this path as a PNG file.}

\item{width}{Numeric.  PNG width in pixels.  Default 2600.}

\item{height}{Numeric.  PNG height in pixels.  Default 1000.}

\item{res}{Numeric.  PNG resolution in DPI.  Default 150.}
}
\value{
The \code{ggplot} object (invisibly).
}
\description{
Reads a VCF at a single genomic position, extracts genotypes, joins with
per-donor gene expression, computes per-cell-type linear-model p-values,
and draws a violin + beeswarm plot faceted by cell type (all panels in a
single row).
}
\details{
By default 10 cell types are plotted.  When \code{gene == "NPAS3"},
\code{microglia__DFC} is appended for 11 panels.
}
