% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_filtering.R
\name{test_eqtl_pval_inflation}
\alias{test_eqtl_pval_inflation}
\title{Diagnose p-value inflation/deflation for eQTL/eGene results}
\usage{
test_eqtl_pval_inflation(
  eqtl_dataframe,
  main_prefix = "eQTL Analysis",
  pval_col = "pval_beta",
  qq_point_size = 1,
  qq_point_alpha = 0.6,
  hist_bins = 40,
  tail_min_p = 0.5
)
}
\arguments{
\item{eqtl_dataframe}{data.frame containing p-values to diagnose.}

\item{main_prefix}{character scalar. Used in plot titles.}

\item{pval_col}{character scalar. Column name holding p-values.}

\item{qq_point_size}{numeric scalar. Point size for QQ plot.}

\item{qq_point_alpha}{numeric scalar. Alpha for QQ plot points.}

\item{hist_bins}{integer scalar. Number of histogram bins.}

\item{tail_min_p}{numeric scalar in [0,1] or NULL. If not NULL, compute a
tail-uniformity summary on p-values satisfying p >= tail_min_p, and draw
the tail reference segment on the histogram.}
}
\value{
A list with:
\describe{
\item{\code{combined_plot}}{Combined QQ + histogram plot (cowplot object).}
\item{\code{stats}}{List containing lambda and tail summary.}
}
}
\description{
Computes a genomic-control style inflation factor (lambda) from p-values
and produces a QQ plot and histogram. Optionally reports a tail-uniformity
summary for p-values >= tail_min_p.
}
\details{
Interpretation:
- lambda_gc summarizes global signal inflation and is only meaningful on the
  full, untruncated p-value distribution.
- Tail diagnostics use a normalized mean ratio where 1.0 indicates the
  expected mean under Uniform(tail_min_p, 1).

The histogram includes a red dashed horizontal segment over [tail_min_p, 1]
at the expected per-bin count under Uniform(tail_min_p, 1).
}
