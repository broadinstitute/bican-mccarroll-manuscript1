% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_filtering.R
\name{compare_eqtl_runs}
\alias{compare_eqtl_runs}
\title{Compare eQTL runs}
\usage{
compare_eqtl_runs(
  cell_type = "MSN",
  region = "CaH",
  baseline_name,
  comparison_name,
  index_file,
  index_file_comparison,
  all_pairs_file,
  all_pairs_file_comparison,
  fdr_threshold = 0.05,
  cache_dir = NULL
)
}
\arguments{
\item{cell_type}{Character scalar. Cell type label used for plot titles and
for locating input files in higher-level wrappers.}

\item{region}{Character scalar. Region label used for plot titles and for
locating input files in higher-level wrappers.}

\item{baseline_name}{Character scalar. Label for the baseline run (used in
plot labels and titles).}

\item{comparison_name}{Character scalar. Label for the comparison run (used
in plot labels and titles).}

\item{index_file}{Character scalar. Path to the baseline index eQTL file
(one top SNP per gene).}

\item{index_file_comparison}{Character scalar. Path to the comparison index
eQTL file (one top SNP per gene).}

\item{all_pairs_file}{Character scalar. Path to the baseline all-pairs file
(all SNP-gene tests).}

\item{all_pairs_file_comparison}{Character scalar. Path to the comparison
all-pairs file (all SNP-gene tests).}

\item{fdr_threshold}{Numeric scalar. FDR threshold used for defining eGenes
and for sign-test evaluation (default 0.05).}

\item{cache_dir}{Character scalar or NULL. Optional override for the cache
directory used to store augmented index files with cross slopes. If NULL,
the default cache directory is used (see Details).}
}
\value{
A named list with:
  \describe{
    \item{final_p1}{A cowplot object containing discovery and effect/q-value
      comparison plots.}
    \item{final_p2}{A cowplot object containing sign-test and p-value inflation
      diagnostic plots.}
    \item{stats_df}{A single-row data.frame of summary statistics for this
      \code{cell_type}/\code{region} comparison.}
  }
}
\description{
Compares two eQTL runs (baseline and comparison) for a given \code{cell_type}
and \code{region}. The function loads the index eQTL results for each run and
augments them with cross-experiment slopes derived from the corresponding
all-pairs (all SNP-gene tests) files. The augmented slopes are used to compute
sign-test concordance between runs.
}
\details{
The function returns two multi-panel plots (intended as two PDF pages):
(1) discovery and effect-size / q-value comparisons, and (2) sign-test and
p-value inflation diagnostics. It also returns a single-row statistics
data.frame summarizing overlap, correlation, yield, and sign-test concordance.

Cross-slope augmentation is cached to avoid repeatedly reading large all-pairs
files. The cache location defaults to a persistent user cache directory and
can be overridden either by setting the \code{EQTL_CACHE_DIR} environment
variable or by providing \code{cache_dir}.
}
