% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_filtering.R
\name{eqtl_cluster_filtering_trajectories}
\alias{eqtl_cluster_filtering_trajectories}
\title{Cluster and visualize eQTL filtering response trajectories}
\usage{
eqtl_cluster_filtering_trajectories(
  df,
  value_col,
  K = 4,
  comparison_col = "comparison_name",
  id_cols = c("cell_type", "region"),
  id_sep = "__",
  drop_incomplete = TRUE,
  seed = 1,
  xlab = "Comparison",
  ylab = NULL,
  title = NULL,
  ylim = NULL
)
}
\arguments{
\item{df}{data.frame in long format containing one row per
\code{id_cols} combination per comparison.}

\item{value_col}{Character scalar giving the column in \code{df} containing
numeric values to cluster (e.g. an effect size, statistic, or residual).}

\item{K}{Integer number of clusters for k-means.}

\item{comparison_col}{Character scalar giving the column in \code{df}
defining the ordered comparison axis (default \code{"comparison_name"}).}

\item{id_cols}{Character vector of columns used to define a composite ID
(e.g. \code{c("cell_type","region")}).}

\item{id_sep}{Character separator used to join \code{id_cols} into a single
\code{id} string.}

\item{drop_incomplete}{Logical. If \code{TRUE}, drop rows with missing
\code{id}, comparison, or value, and (after reshaping) drop \code{id}s with
any missing comparison values.}

\item{seed}{Integer seed for k-means initialization.}

\item{xlab}{Character x-axis label for the trajectories plot.}

\item{ylab}{Character y-axis label for the trajectories plot. If \code{NULL},
defaults to \code{value_col}.}

\item{title}{Character title for the trajectories plot. If \code{NULL},
defaults to \code{"Filtering response clusters (K = <K>)"}.}

\item{ylim}{Optional numeric length-2 vector giving y-axis limits (applied
via \code{coord_cartesian}).}
}
\description{
Given a long-format table of responses across a set of comparisons (e.g.
filtering levels), this function reshapes the data into a wide matrix of
trajectories (one row per \code{id}, one column per comparison), performs
k-means clustering on these trajectories, and returns plots and cluster
assignments.
}
\details{
The primary plot shows per-\code{id} trajectories colored by cluster, with
the cluster mean trajectory overlaid as a dashed line. A second plot maps
each \code{id} to its assigned cluster.
}
