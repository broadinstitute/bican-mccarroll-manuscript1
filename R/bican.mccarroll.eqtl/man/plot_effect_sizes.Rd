% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_effect_sizes_pairs.R
\name{plot_effect_sizes}
\alias{plot_effect_sizes}
\title{Plot pairwise eQTL effect sizes across cell types within a region}
\usage{
plot_effect_sizes(
  data_dir,
  region,
  cell_types_file,
  outPDF,
  fdr_threshold = 0.05,
  nrow = 2,
  ncol = 2
)
}
\arguments{
\item{data_dir}{Character scalar. Path to the results root directory.}

\item{region}{Character scalar. Region identifier used in directory and file
naming (e.g., \code{"DFC"}, \code{"CaH"}).}

\item{cell_types_file}{Character scalar. Path to a text file containing one
cell type prefix per line (e.g., \code{"GABA_CGE_DFC"}). Region is supplied
separately via \code{region}.}

\item{outPDF}{Character scalar. Output PDF filepath.}

\item{fdr_threshold}{Numeric scalar. FDR/q-value threshold used to define
significant eGenes in the index tables. Default is \code{0.05}.}

\item{nrow}{Integer scalar. Number of plot rows per PDF page. Default is \code{2}.}

\item{ncol}{Integer scalar. Number of plot columns per PDF page. Default is \code{2}.}
}
\description{
Generates scatter plots comparing eQTL effect sizes (slopes) for all unordered
pairs of cell types listed in \code{cell_types_file}, restricted to a single
\code{region}. All data are read from a single results directory.
}
\details{
For a single pair of cell types (A, B), the procedure is:
\enumerate{
  \item Read each cell type's index eQTL table (\code{*.cis_qtl_ann.txt.gz})
        and filter to significant eGenes with \code{qval < fdr_threshold}.
  \item Form the union of significant genes across A and B, and select a
        single reference SNP per gene using the index tables:
        choose the most significant (smallest) \code{qval}; if tied, choose
        the larger \code{abs(slope)}.
  \item For each chosen (gene, SNP) pair, read each cell type's all-pairs table
        (\code{*.cis_qtl_pairs.txt.gz}) and extract the slope for that exact
        (gene, SNP), yielding comparable effect sizes measured at the same SNP
        in both cell types (no allele flipping is required).
  \item Plot \code{slope_A} vs \code{slope_B} with a \code{y = x} reference line
        and annotate the Pearson correlation.
}

Plots are written to a single multi-page PDF with \code{nrow} x \code{ncol}
plots per page. Pair ordering follows the order of \code{cell_types_file}.
}
