% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/heatmap_index_snp_median_expression.R
\name{get_heatmap_index_snp_median_expression}
\alias{get_heatmap_index_snp_median_expression}
\title{Get median gene expression per cell type for heatmap index-SNP genes}
\usage{
get_heatmap_index_snp_median_expression(
  index_snp_path,
  region_cell_type_path,
  expression_path,
  output_path = NULL
)
}
\arguments{
\item{index_snp_path}{Character scalar.  Path to the index-SNP slope
matrix TSV (output of
\code{\link{get_index_snp_slope_matrix_with_median_impute}}).
Only the \code{phenotype_id} column is used.}

\item{region_cell_type_path}{Character scalar.  Path to a tab-delimited
file with columns \code{cell_type} and \code{region}.}

\item{expression_path}{Character scalar.  Path to the combined gene
expression TPM matrix TSV.  First column should be gene IDs
(\code{pid}); remaining columns are sample-level expression values
with names formatted as \code{<sample>_<cell_type>__<region>}.}

\item{output_path}{Character scalar or \code{NULL}.  If non-NULL, the
result is written to this path as a tab-delimited file.}
}
\value{
A \code{data.table} with columns \code{Gene} and one column
  per cell type / region group containing median expression values.
}
\description{
For each cell type / region group, computes the median TPM expression
across samples, then filters to the genes present in the index-SNP
slope matrix (i.e. heatmap genes).  NA values within each gene row
are replaced with the row median.
}
