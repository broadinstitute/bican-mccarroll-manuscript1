% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/index_snp_slope_matrix.R
\name{get_index_snp_slope_matrix_with_impute}
\alias{get_index_snp_slope_matrix_with_impute}
\title{Select index SNPs per gene and build a sign-adjusted, imputed slope matrix}
\usage{
get_index_snp_slope_matrix_with_impute(
  slope_matrix_path,
  min_non_na = 3,
  imputation_method = "median",
  output_path = NULL
)
}
\arguments{
\item{slope_matrix_path}{Character scalar. Path to the slope matrix file.}

\item{min_non_na}{Integer scalar. Minimum number of non-NA slope values
required to retain a gene when \code{imputation_method = "median"}.
Default \code{3}.}

\item{imputation_method}{Character scalar. One of \code{"median"} or
\code{"zero"}. Default \code{"median"}.}

\item{output_path}{Character scalar or \code{NULL}. If non-NULL, the result
table is written to this path as a tab-delimited file.}
}
\value{
A \code{data.table} with identifier columns and one sign-adjusted,
  imputed slope column per cell type / region.
}
\description{
Starting from the full slope matrix (eGene-variant pairs x cell type/region),
this function:
\enumerate{
  \item Selects one index variant per gene - the variant with the largest
        absolute slope across all cell types.
  \item Adjusts signs so the cell type with the largest absolute slope is
        always positive (ensures consistent orientation across genes).
  \item Imputes missing values using \code{imputation_method}. When
        \code{"median"} is used, genes with fewer than \code{min_non_na}
        non-NA values are dropped.
}
}
